library(ggplot2)
library(tidyverse)
df = read.table('../a_domain_per_res_prot_block_change.txt', header=TRUE)
View(df)
colnames(df)
ggplot(df, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(.~same_dom_type_in_alt_seg)
# all-sub. domain blocks
dfs = df %>% filter(sub_perc_diff != '-')
ggplot(dfs, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(.~same_dom_type_in_alt_seg)
ggplot(dfs, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(.~same_dom_type_in_alt_seg)
View(dfs)
help("read.table")
df = read.table('../a_domain_per_res_prot_block_change.txt', header=TRUE, na.strings='-')
ggplot(df, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(.~same_dom_type_in_alt_seg)
ggplot(df, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~.)
set_theme(theme_bw())
theme_set(theme_bw())
ggplot(df, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~.)
ggplot(df, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
colnames(df)
colnames(df)
# all-sub. domain blocks
dfs = df %>% filter(sub_perc_diff != 'NA')
ggplot(dfs, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
dfs$same_dom_type_in_alt_seg = factor(df$same_dom_type_in_alt_seg, labels=c('Domain in alt. iso.', 'Domain missing in alt. iso.'))
ggplot(dfs, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
ggplot(dfs, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
dfs$same_dom_type_in_alt_seg = factor(df$same_dom_type_in_alt_seg, labels=c('Domain in alt. iso.', 'Domain missing in alt. iso.'))
dfs$same_dom_type_in_alt_seg = factor(dfs$same_dom_type_in_alt_seg, labels=c('Domain in alt. iso.', 'Domain missing in alt. iso.'))
ggplot(dfs, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
dfs$same_dom_type_in_alt_seg = factor(dfs$same_dom_type_in_alt_seg, labels=c('Same domain-type missing in alt. iso.', 'Same domain-type in alt. iso.'))
dfs$same_dom_type_in_alt_seg = factor(dfs$same_dom_type_in_alt_seg, labels=c('Same domain-type missing in alt. iso.', 'Same domain-type in alt. iso.'))
ggplot(dfs, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
df = read.table('../a_domain_per_res_prot_block_change.txt', header=TRUE, na.strings='-')
colnames(df)
# all-sub. domain blocks
dfs = df %>% filter(sub_perc_diff != 'NA')
dfs = dfs %>% mutate(is_zf = case_when(grepl('zf', dom_name, ignore.case=TRUE) ~ 'is_ZF', TRUE ~ 'not_ZF')
dfs = dfs %>% mutate(is_zf = case_when(grepl('zf', dom_name, ignore.case=TRUE) ~ 'is_ZF', TRUE ~ 'not_ZF'))
dfs = dfs %>% mutate(is_zf = case_when(grepl('zf', dom_name, ignore.case=TRUE) ~ 'is_ZF', TRUE ~ 'not_ZF'))
dfs$same_dom_type_in_alt_seg = factor(dfs$same_dom_type_in_alt_seg, labels=c('Same domain-type missing in alt. iso.', 'Same domain-type in alt. iso.'))
dfs$same_dom_type_in_alt_seg = factor(dfs$same_dom_type_in_alt_seg, labels=c('Same domain-type missing in alt. iso.', 'Same domain-type in alt. iso.'))
ggplot(dfs, aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
ggsave('distr_perc_diff_sub_seg_lens_facet_dom_map_in_alt.pdf', width=4, height=7)
ggsave('distr_perc_diff_sub_seg_lens_facet_dom_map_in_alt.pdf', width=4, height=6)
ggsave('distr_perc_diff_sub_seg_lens_facet_dom_map_in_alt.pdf', width=4, height=5)
ggsave('distr_perc_diff_sub_seg_lens_facet_dom_map_in_alt.pdf', width=5, height=5)
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs[dfs$same_dom_type_in_alt_seg='1',], aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs[dfs$same_dom_type_in_alt_seg=='1',], aes(x=sub_perc_diff)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs[dfs$same_dom_type_in_alt_seg=='1',], aes(x=sub_perc_diff)) + geom_histogram()
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
dfs[dfs$same_dom_type_in_alt_seg=='1',]
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
dfs[,dfs$same_dom_type_in_alt_seg=='1']
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
dfs[,dfs$same_dom_type_in_alt_seg=='1']
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
dfs[which(dfs$same_dom_type_in_alt_seg=='1'), ]
dfs$same_dom_type_in_alt_seg = factor(levels=dfs$same_dom_type_in_alt_seg, labels=c('Same domain-type missing in alt. iso.', 'Same domain-type in alt. iso.'))
# all-sub. domain blocks
dfs = df %>% filter(sub_perc_diff != 'NA')
# all-sub. domain blocks
dfs = df %>% filter(sub_perc_diff != 'NA')
dfs = dfs %>% mutate(is_zf = case_when(grepl('zf', dom_name, ignore.case=TRUE) ~ 'is_ZF', TRUE ~ 'not_ZF'))
dfs$same_dom_type_in_alt_seg = factor(levels=dfs$same_dom_type_in_alt_seg, labels=c('Same domain-type missing in alt. iso.', 'Same domain-type in alt. iso.'))
# all-sub. domain blocks
dfs = df %>% filter(sub_perc_diff != 'NA')
dfs = dfs %>% mutate(is_zf = case_when(grepl('zf', dom_name, ignore.case=TRUE) ~ 'is_ZF', TRUE ~ 'not_ZF'))
dfs$same_dom_type_in_alt_seg = factor(dfs$same_dom_type_in_alt_seg, levels=c(0, 1), labels=c('Same domain-type missing in alt. iso.', 'Same domain-type in alt. iso.'))
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
dfs[which(dfs$same_dom_type_in_alt_seg=='1'), ]
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
dfs[which(dfs$same_dom_type_in_alt_seg==1), ]
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs, aes(x=sub_perc_diff, fill=is_zf)) + geom_histogram() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs, aes(x=sub_perc_diff, fill=is_zf)) + geom_histogram(position='identity') + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs, aes(x=sub_perc_diff, fill=is_zf)) + geom_histogram(position='identity', alpha=0.5) + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs, aes(x=sub_perc_diff, fill=is_zf)) + geom_histogram(position='identity', alpha=0.5) + scale_y_log10() + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs, aes(x=sub_perc_diff, fill=is_zf)) + geom_histogram(position='identity', alpha=0.5) + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs, aes(x=sub_perc_diff, fill=is_zf)) + geom_histogram(position='identity', alpha=0.5, bindiwth=1) + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs, aes(x=sub_perc_diff, fill=is_zf)) + geom_histogram(position='identity', alpha=0.5, binwidth=1) + facet_grid(same_dom_type_in_alt_seg~., scales='free_y')
# distr. of subst. seg. perc. diff. in len, colored by if is ZF
ggplot(dfs, aes(x=sub_perc_diff, fill=is_zf)) + geom_histogram(position='identity', alpha=0.5, binwidth=1) + facet_grid(same_dom_type_in_alt_seg~., scales='free_y') + xlab('Subst. domain segment, perc. diff b/t ref/alt')
ggsave('distr_perc_diff_sub_seg_lens_facet_dom_map_in_alt_fill_zf.pdf', width=5, height=5)
